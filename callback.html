<!DOCTYPE html>
<html>
<head>
    <title>Google Auth Callback</title>
    <script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align:center; margin-top:50px; }
        img { border-radius:50%; margin-top:10px; }
    </style>
</head>
<body>
    <h1>Google Auth Callback</h1>
    <div id="user-info"></div>

    <script>
        // Parse access token from URL fragment
        const hash = window.location.hash.substring(1); // remove #
        const params = new URLSearchParams(hash);
        const accessToken = params.get("access_token");

        const userDiv = document.getElementById("user-info");

        if (accessToken) {
            // Fetch user profile from Google API
            fetch("https://www.googleapis.com/oauth2/v3/userinfo", {
                headers: { "Authorization": "Bearer " + accessToken }
            })
            .then(res => res.json())
            .then(data => {
                console.log("User data:", data);
                userDiv.innerHTML = `
                    <h2>Welcome, ${data.name}!</h2>
                    <p>Email: ${data.email}</p>
                    <img src="${data.picture}" width="100">
                `;
            })
            .catch(err => {
                userDiv.textContent = "Error fetching user info: " + err;
            });
        } else {
            userDiv.textContent = "No access token received.";
        }
    </script>
</body>
</html>
